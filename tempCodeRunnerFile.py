masked_loss_function